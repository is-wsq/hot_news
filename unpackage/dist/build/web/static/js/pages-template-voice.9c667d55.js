(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-template-voice"],{"19d2":function(t,i,e){var a=e("c86c");i=a(!1),i.push([t.i,".voice[data-v-650f04ea]{height:100vh;color:#fff}.voice-list[data-v-650f04ea]{display:grid;grid-template-columns:repeat(auto-fill,minmax(80px,1fr));grid-auto-rows:110px;gap:20px;overflow-y:auto}.voice-item[data-v-650f04ea]{text-align:center}.loading-title[data-v-650f04ea]{position:absolute;color:#fff;font-size:14px;width:100%;text-align:center;top:50%;-webkit-transform:translateY(-50%);transform:translateY(-50%);display:flex;align-items:center;justify-content:center}.dot[data-v-650f04ea]{width:20px;text-align:left;margin-left:5px;font-size:16px;line-height:40px}.voice-name[data-v-650f04ea]{width:100%;text-align:center;font-size:14px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.active-item[data-v-650f04ea]{border:1px solid #e99d42}",""]),t.exports=i},"466d":function(t,i,e){"use strict";e.d(i,"b",(function(){return n})),e.d(i,"c",(function(){return o})),e.d(i,"a",(function(){return a}));var a={uniIcons:e("00f9").default},n=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("v-uni-view",{staticClass:"pages voice"},[e("v-uni-view",{staticClass:"nav-bar-header"},[e("uni-icons",{staticClass:"nav-bar-back",attrs:{type:"left",size:"21",color:"#ffffff"},on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.back.apply(void 0,arguments)}}}),e("v-uni-view",{staticClass:"nav-bar-title"},[t._v("音色列表")])],1),e("v-uni-view",{staticStyle:{"font-size":"18px",color:"#ffffff","margin-bottom":"15px"}},[t._v("系统音色")]),e("v-uni-view",{staticClass:"voice-list",style:{height:t.heightStyle+"px"}},t._l(t.systemVoice,(function(i){return e("v-uni-view",{key:i.id,staticClass:"voice-item",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.previewAudio(i)}}},[e("v-uni-image",{class:{"active-item":t.audioCtxId===i.id},staticStyle:{width:"80px",height:"80px","border-radius":"50%"},attrs:{src:i.avatar,mode:"aspectFill"}}),e("v-uni-view",{staticClass:"voice-name",style:{color:t.audioCtxId===i.id?"#e99d42":"#ffffff"}},[t._v(t._s(i.name))])],1)})),1),e("v-uni-view",{staticStyle:{"font-size":"18px",color:"#ffffff",margin:"15px 0"}},[t._v("我的音色")]),e("v-uni-view",{staticClass:"voice-list",style:{height:t.heightStyle+"px"}},[t._l(t.processVoice,(function(i){return e("v-uni-view",{key:i.id,staticClass:"voice-item"},[e("v-uni-view",{staticClass:"image-wrapper shining"},[e("v-uni-image",{staticStyle:{width:"80px",height:"80px","border-radius":"50%"},attrs:{src:"/static/img/voice-loading.png",mode:"aspectFill"}}),e("v-uni-view",{staticClass:"shine-layer"}),e("v-uni-view",{staticClass:"loading-title"},[e("v-uni-view",{staticStyle:{"font-size":"14px"}},[t._v("克隆中")]),e("v-uni-view",{staticClass:"dot"},[t._v(t._s(t.dot))])],1)],1),e("v-uni-view",{staticClass:"voice-name"},[t._v(t._s(i.name))])],1)})),t._l(t.cloneVoice,(function(i){return e("v-uni-view",{key:i.id,staticClass:"voice-item",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.previewAudio(i)}}},[e("v-uni-image",{class:{"active-item":t.audioCtxId===i.id},staticStyle:{width:"80px",height:"80px","border-radius":"50%"},attrs:{src:i.avatar,mode:"aspectFill"}}),e("v-uni-view",{staticClass:"voice-name",style:{color:t.audioCtxId===i.id?"#e99d42":"#ffffff"}},[t._v(t._s(i.name))])],1)}))],2)],1)},o=[]},"4c07":function(t,i,e){"use strict";e("6a54");var a=e("f5bd").default;Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0,e("8f71"),e("bf0f"),e("a578");var n=a(e("9b1b")),o=e("8f59"),s={name:"voice",data:function(){return{heightStyle:0,audioCtx:null,audioCtxId:null,dotCount:1,dotTimer:null,dot:"."}},computed:(0,n.default)((0,n.default)({},(0,o.mapGetters)("task",["voiceTasks"])),{},{processVoice:function(){return this.voiceTasks.filter((function(t){return"pending"===t.status}))},systemVoice:function(){return this.voiceTasks.filter((function(t){return"system"===t.type}))},cloneVoice:function(){return this.voiceTasks.filter((function(t){return"clone"===t.type&&"success"===t.status}))}}),mounted:function(){this.$store.dispatch("task/pollVoiceTasks"),this.startDotAnimation(),this.heightStyle=(uni.getSystemInfoSync().safeArea.height-200)/2},beforeDestroy:function(){clearInterval(this.dotTimer),this.stopPreviewAudio()},methods:{startDotAnimation:function(){var t=this;this.dotTimer=setInterval((function(){t.dotCount=t.dotCount%3+1,t.dot=".".repeat(t.dotCount)}),1e3)},previewAudio:function(t){var i=this;this.audioCtxId!==t.id?(this.audioCtx&&this.stopPreviewAudio(),this.audioCtx=uni.createInnerAudioContext(),this.audioCtx.src=t.filepath,this.audioCtx.autoplay=!0,this.audioCtx.play(),this.audioCtx.onPlay((function(){i.audioCtxId=t.id})),this.audioCtx.onEnded((function(){i.stopPreviewAudio()}))):this.stopPreviewAudio()},stopPreviewAudio:function(){this.audioCtx&&(this.audioCtx.pause(),this.audioCtx.destroy(),this.audioCtx=null,this.audioCtxId=null)},back:function(){uni.redirectTo({url:"/pages/template/voicesClone"})}}};i.default=s},"6e73":function(t,i,e){"use strict";var a=e("970f"),n=e.n(a);n.a},"89ef":function(t,i,e){"use strict";e.r(i);var a=e("4c07"),n=e.n(a);for(var o in a)["default"].indexOf(o)<0&&function(t){e.d(i,t,(function(){return a[t]}))}(o);i["default"]=n.a},"970f":function(t,i,e){var a=e("19d2");a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var n=e("967d").default;n("04f7656e",a,!0,{sourceMap:!1,shadowMode:!1})},a578:function(t,i,e){"use strict";var a=e("8bdb"),n=e("f298");a({target:"String",proto:!0},{repeat:n})},ac26:function(t,i,e){"use strict";e.r(i);var a=e("466d"),n=e("89ef");for(var o in n)["default"].indexOf(o)<0&&function(t){e.d(i,t,(function(){return n[t]}))}(o);e("6e73");var s=e("828b"),r=Object(s["a"])(n["default"],a["b"],a["c"],!1,null,"650f04ea",null,!1,a["a"],void 0);i["default"]=r.exports},f298:function(t,i,e){"use strict";var a=e("497b"),n=e("9e70"),o=e("862c"),s=RangeError;t.exports=function(t){var i=n(o(this)),e="",r=a(t);if(r<0||r===1/0)throw new s("Wrong number of repetitions");for(;r>0;(r>>>=1)&&(i+=i))1&r&&(e+=i);return e}}}]);