(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-template-voicesClone"],{"47f6":function(t,e,i){"use strict";var a=i("81e2"),n=i.n(a);n.a},"544a":function(t,e,i){"use strict";i.d(e,"b",(function(){return n})),i.d(e,"c",(function(){return o})),i.d(e,"a",(function(){return a}));var a={uniIcons:i("00f9").default,uniPopup:i("3182").default},n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",{staticClass:"pages voicesClone"},[i("v-uni-view",{staticClass:"nav-bar-header"},[i("uni-icons",{staticClass:"nav-bar-back",attrs:{type:"left",size:"21",color:"#ffffff"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.back.apply(void 0,arguments)}}}),i("v-uni-view",{staticClass:"nav-bar-title"},[t._v("音色克隆")]),i("v-uni-view",{staticClass:"voices-list",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.gotoVoices.apply(void 0,arguments)}}},[t._v("音色列表")])],1),i("v-uni-view",{staticClass:"voice-content"},[i("v-uni-view",{staticStyle:{"margin-bottom":"15px"}},[t._v("正确示例")]),i("v-uni-view",{staticStyle:{display:"flex"}},[i("v-uni-view",{staticClass:"template-img"}),i("v-uni-view",{staticClass:"template-requires"},t._l(t.requires,(function(e,a){return i("v-uni-view",{key:a,staticStyle:{height:"40px",display:"flex","align-items":"center"}},[i("uni-icons",{staticStyle:{margin:"0 5px"},attrs:{type:"checkbox-filled",size:"22",color:"#77C285"}}),i("v-uni-view",{staticStyle:{"font-size":"14px"}},[t._v(t._s(e))])],1)})),1)],1),i("v-uni-view",{staticStyle:{margin:"15px 0"}},[t._v("克隆案例")]),i("v-uni-view",{staticStyle:{display:"flex",gap:"30px"}},[i("v-uni-view",{staticClass:"clone-case"},[i("v-uni-view",{staticClass:"clone-case-title"},[t._v("原声")]),i("v-uni-view",{staticClass:"clone-case-btn"},[0!==t.playIndex?i("uni-icons",{staticClass:"off-on",attrs:{fontFamily:"CustomFont",size:"18",color:"#ffffff"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.playAudio(0)}}},[t._v(t._s(""))]):i("uni-icons",{staticClass:"off-on",attrs:{fontFamily:"CustomFont",size:"18",color:"#ffffff"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.stopAudio()}}},[t._v(t._s(""))])],1)],1),i("v-uni-view",{staticClass:"clone-case"},[i("v-uni-view",{staticClass:"clone-case-title"},[t._v("克隆")]),i("v-uni-view",{staticClass:"clone-case-btn"},[1!==t.playIndex?i("uni-icons",{staticClass:"off-on",attrs:{fontFamily:"CustomFont",size:"18",color:"#ffffff"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.playAudio(1)}}},[t._v(t._s(""))]):i("uni-icons",{staticClass:"off-on",attrs:{fontFamily:"CustomFont",size:"18",color:"#ffffff"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.stopAudio()}}},[t._v(t._s(""))])],1)],1)],1),i("v-uni-view",{staticStyle:{margin:"15px 0"}},[t._v("音频教程")]),i("v-uni-view",{staticClass:"voice-tutorial"},[i("v-uni-view",{staticClass:"voice-tutorial-btn"},[2!==t.playIndex?i("uni-icons",{staticClass:"off-on",attrs:{fontFamily:"CustomFont",size:"22",color:"#ffffff"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.playAudio(2)}}},[t._v(t._s(""))]):i("uni-icons",{staticClass:"off-on",attrs:{fontFamily:"CustomFont",size:"22",color:"#ffffff"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.stopAudio()}}},[t._v(t._s(""))])],1)],1)],1),i("v-uni-view",{staticStyle:{height:"90px",display:"flex","align-items":"center",gap:"30px"}},[i("v-uni-button",{staticClass:"transcribe",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.gotoTranscribe.apply(void 0,arguments)}}},[t._v("在线录制")]),i("v-uni-button",{staticClass:"upload",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.uploadFile.apply(void 0,arguments)}}},[t._v("上传文件")])],1),i("uni-popup",{ref:"recorder",attrs:{"mask-click":!1,type:"bottom","background-color":"#292929",borderRadius:"12px 12px 0 0"}},[i("v-uni-view",{staticClass:"popup-content"},[i("v-uni-view",{staticStyle:{height:"200px","line-height":"50px"}},[i("v-uni-view",{staticClass:"text"},t._l(t.chars,(function(e,a){return i("v-uni-text",{key:a,staticClass:"word",class:{active:t.started},style:t.started?{animationDelay:a*t.delayStep+"s"}:{}},[t._v(t._s(e))])})),1)],1),i("v-uni-view",{staticStyle:{"font-size":"14px","margin-top":"20px","text-align":"center"}}),i("v-uni-view",{staticClass:"recorder-content"},[i("v-uni-canvas",{staticClass:"circle-canvas",attrs:{"canvas-id":"progressCircle"}}),t.audioUrl?i("v-uni-view",{staticClass:"microphone-icon"},[3!==t.playIndex?i("uni-icons",{attrs:{fontFamily:"CustomFont",size:"25",color:"#ffffff"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.playAudio(3)}}},[t._v(t._s(""))]):i("uni-icons",{attrs:{fontFamily:"CustomFont",size:"25",color:"#ffffff"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.stopAudio()}}},[t._v(t._s(""))])],1):i("v-uni-view",{staticClass:"microphone-icon"},[t.isRecording?i("uni-icons",{attrs:{fontFamily:"CustomFont",size:"25",color:"#ffffff"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.stopRecording()}}},[t._v(t._s(""))]):i("uni-icons",{attrs:{type:"mic-filled",size:"30",color:"#ffffff"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.startRecording.apply(void 0,arguments)}}})],1),i("v-uni-view",{staticClass:"timer"},[t._v(t._s(t.formatTime(t.duration)))]),i("v-uni-view",{staticStyle:{"margin-top":"20px","font-size":"14px","text-align":"center",height:"40px"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.reRecord.apply(void 0,arguments)}}},[t._v(t._s(t.audioUrl?"":"重新录制"))]),i("v-uni-view",{staticStyle:{display:"flex",gap:"30px","margin-top":"20px"}},[i("v-uni-button",{staticClass:"recorder-btn",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.$refs.recorder.close.apply(void 0,arguments)}}},[t._v("取消")]),i("v-uni-button",{staticClass:"recorder-btn",staticStyle:{"background-color":"#e99d42"}},[t._v("完成")])],1)],1)],1)],1)],1)},o=[]},"73e1":function(t,e,i){"use strict";var a=i("29d8");t.exports=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(a)},"795c":function(t,e,i){"use strict";var a=i("8bdb"),n=i("db04").start,o=i("73e1");a({target:"String",proto:!0,forced:o},{padStart:function(t){return n(this,t,arguments.length>1?arguments[1]:void 0)}})},"81e2":function(t,e,i){var a=i("a118");a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var n=i("967d").default;n("4702779e",a,!0,{sourceMap:!1,shadowMode:!1})},9327:function(t,e,i){"use strict";var a=i("8bdb"),n=i("9f69"),o=i("1ded").f,s=i("c435"),r=i("9e70"),c=i("b6a1"),l=i("862c"),d=i("0931"),u=i("a734"),f=n("".slice),p=Math.min,v=d("endsWith"),h=!u&&!v&&!!function(){var t=o(String.prototype,"endsWith");return t&&!t.writable}();a({target:"String",proto:!0,forced:!h&&!v},{endsWith:function(t){var e=r(l(this));c(t);var i=arguments.length>1?arguments[1]:void 0,a=e.length,n=void 0===i?a:p(s(i),a),o=r(t);return f(e,n-o.length,n)===o}})},a118:function(t,e,i){var a=i("c86c");e=a(!1),e.push([t.i,"@font-face{font-family:CustomFont;src:url(/static/iconfont.ttf)}.voicesClone[data-v-5ed49886]{height:100vh;color:#fff}.voices-list[data-v-5ed49886]{position:absolute;right:5px;color:#fff}.voice-content[data-v-5ed49886]{height:calc(100% - 150px);overflow-y:auto}.template-img[data-v-5ed49886]{background-image:url(/static/img/microphone.png);border-radius:10px;width:180px;height:240px;margin-right:5px;background-size:cover;background-repeat:no-repeat;background-position:50%}.clone-case[data-v-5ed49886]{flex:1;border-radius:10px;height:82px;background-image:url(/static/img/case.png);background-size:cover;background-repeat:no-repeat;position:relative}.clone-case-title[data-v-5ed49886]{position:absolute;bottom:5px;left:5px;color:#fff;font-size:14px}.clone-case-btn[data-v-5ed49886]{position:absolute;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);width:45px;height:45px;border-radius:50%;background-color:rgba(16,16,16,.15);display:flex;justify-content:center;align-items:center}.voice-tutorial[data-v-5ed49886]{height:150px;border-radius:10px;background-image:url(/static/img/microphone_copy.png);background-size:cover;background-repeat:no-repeat;position:relative}.voice-tutorial-btn[data-v-5ed49886]{position:absolute;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);width:60px;height:60px;border-radius:50%;background-color:rgba(16,16,16,.15);display:flex;justify-content:center;align-items:center}.transcribe[data-v-5ed49886]{flex:1;height:55px;line-height:55px;border-radius:10px}.upload[data-v-5ed49886]{flex:1;height:55px;line-height:55px;background-color:#e99d42;color:#fff;border-radius:10px}.popup-content[data-v-5ed49886]{background-color:#292929;border-top-left-radius:12px;border-top-right-radius:12px;padding:10px;height:500px}.popup-title[data-v-5ed49886]{display:flex;align-items:center;justify-content:center;position:relative}.recorder-content[data-v-5ed49886]{position:relative;height:100px}.circle-canvas[data-v-5ed49886]{width:100px;height:100px;margin:20px auto 0}.microphone-icon[data-v-5ed49886]{position:absolute;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}.timer[data-v-5ed49886]{margin-top:10px;text-align:center;font-size:14px;color:#666}.recorder-btn[data-v-5ed49886]{flex:1;height:45px;line-height:45px;font-size:14px;border-radius:8px;color:#101010}.text[data-v-5ed49886]{font-size:16px;color:#888;display:flex;flex-wrap:wrap;text-align:center}.word[data-v-5ed49886]{opacity:1;color:#888}.word.active[data-v-5ed49886]{-webkit-animation:highlight-data-v-5ed49886 .5s forwards;animation:highlight-data-v-5ed49886 .5s forwards}@-webkit-keyframes highlight-data-v-5ed49886{from{color:#888}to{color:#e99d42}}@keyframes highlight-data-v-5ed49886{from{color:#888}to{color:#e99d42}}",""]),t.exports=e},b93e:function(t,e,i){"use strict";i.r(e);var a=i("544a"),n=i("dcec");for(var o in n)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return n[t]}))}(o);i("47f6");var s=i("828b"),r=Object(s["a"])(n["default"],a["b"],a["c"],!1,null,"5ed49886",null,!1,a["a"],void 0);e["default"]=r.exports},db04:function(t,e,i){"use strict";var a=i("bb80"),n=i("c435"),o=i("9e70"),s=i("f298"),r=i("862c"),c=a(s),l=a("".slice),d=Math.ceil,u=function(t){return function(e,i,a){var s,u,f=o(r(e)),p=n(i),v=f.length,h=void 0===a?" ":o(a);return p<=v||""===h?f:(s=p-v,u=c(h,d(s/h.length)),u.length>s&&(u=l(u,0,s)),t?f+u:u+f)}};t.exports={start:u(!1),end:u(!0)}},dcec:function(t,e,i){"use strict";i.r(e);var a=i("fca3"),n=i.n(a);for(var o in a)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return a[t]}))}(o);e["default"]=n.a},f298:function(t,e,i){"use strict";var a=i("497b"),n=i("9e70"),o=i("862c"),s=RangeError;t.exports=function(t){var e=n(o(this)),i="",r=a(t);if(r<0||r===1/0)throw new s("Wrong number of repetitions");for(;r>0;(r>>>=1)&&(e+=e))1&r&&(i+=e);return i}},fca3:function(t,e,i){"use strict";i("6a54"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,i("bf0f"),i("9327"),i("5ef2"),i("c223"),i("20f3"),i("c9b5"),i("ab80"),i("18f7"),i("de6c"),i("dc89"),i("2425"),i("795c"),i("4ec3");var a="Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJodHRwczovL2xpdmUudGVsbGFpLnRlY2giLCJzdWIiOiI3ODNjNGI1NC1hMWQwLTVmY2ItOTExZC1kNWM1YjNjODY2MTAiLCJpYXQiOjE3NDIyMTA0NDQsImV4cCI6MTc1OTc5NTIwMCwibmFtZSI6InRlc3QifQ.OGrW6VfdM7zLVcGjGz9UHblQQlQoHWSriFB90kJOq98",n={data:function(){return{requires:["30秒左右的视频、音频","录制环境安静无杂音","确保录制全程环境一致","保持正常语速、音调","保留自然停顿"],playIndex:null,audioCtx:null,audios:["https://live.tellai.tech/api/news_assistant/static/generated_sample_audio/272f4122-ab74-4bc1-9cd6-c29a41fb508f/20250327145319386.wav","https://live.tellai.tech/api/news_assistant/static/generated_sample_audio/272f4122-ab74-4bc1-9cd6-c29a41fb508f/20250326155734776.wav","https://live.tellai.tech/api/news_assistant/static/generated_sample_audio/272f4122-ab74-4bc1-9cd6-c29a41fb508f/20250326154431855.wav"],duration:0,interval:null,progress:0,ctx:null,isRecording:!1,audioUrl:null,recorderFile:null,sentence:"现在做视频真的太简单了，使用奇点数字人，不用真人出镜也能出爆款视频。",delayStep:.277,started:!1}},computed:{chars:function(){return this.sentence.split("")}},mounted:function(){this.ctx=uni.createCanvasContext("progressCircle",this)},methods:{uploadFile:function(){var t=this;uni.chooseFile({count:1,success:function(e){var i=e.tempFiles[0].name.toLowerCase(),a=[".mp3",".wav",".m4a",".mp4",".mov"].some((function(t){return i.toLowerCase().endsWith(t)}));if(a){var n=-1!==e.tempFiles[0].type.indexOf("audio")?"audio":"video";console.log(e.tempFiles[0]),t.getFileId(n,e.tempFiles[0])}else t.$tip.confirm("请选择有效的音频文件",!1)}})},getFileId:function(t,e){var i=this,n=this;uni.request({url:"https://live.tellai.tech/api/media/files/upload_request?type=".concat(t),header:{Authorization:a},success:function(o){var s=o.data.base_resp,r=o.data.data;if(200===s.status_code){var c={name:e.name,type:"voice",id:n.generateUniqueId()};n.$store.dispatch("task/addTask",c),n.$tip.confirm("已创建音色克隆任务\n《".concat(e.name,"》"),!1).then((function(t){uni.redirectTo({url:"/pages/template/voice"})})),uni.uploadFile({url:r.upload_url,filePath:e.path,name:"file",header:{Authorization:a},timeout:18e5,formData:{file_id:r.file_id,type:t},success:function(t){var e=JSON.parse(t.data).base_resp,i=JSON.parse(t.data).data;200===e.status_code?n.clone(i.file_id,c):(n.$store.dispatch("task/removeTask",c.id),n.$tip.confirm("".concat(c.name,"音色克隆任务失败,").concat(e.status_msg),!1))}})}else i.$tip.confirm(s.status_msg,!1)}})},clone:function(t,e){var i=this,a={file_id:t,user_id:uni.getStorageSync("userId"),audio_name:e.name.substring(0,e.name.lastIndexOf("."))};this.$http.post("/timbres/clone/file_id",a).then((function(t){i.$store.dispatch("task/removeTask",e.id),"success"===t.status?i.$tip.confirm("".concat(e.name,"音色克隆任务成功"),!1):i.$tip.confirm("".concat(e.name,"音色克隆任务失败,").concat(t.message),!1)}))},playAudio:function(t){var e=this;this.audioCtx&&this.stopAudio(),this.audioCtx=uni.createInnerAudioContext(),this.audioCtx.src=3===t?this.audioUrl:this.audios[t],this.audioCtx.autoplay=!0,this.audioCtx.play(),this.audioCtx.onPlay((function(){e.playIndex=t})),this.audioCtx.onEnded((function(){e.stopAudio()}))},stopAudio:function(){this.audioCtx&&(this.audioCtx.pause(),this.audioCtx.destroy(),this.audioCtx=null,this.playIndex=null)},generateUniqueId:function(){return Date.now()+Math.random().toString(36).substr(2,16)},back:function(){uni.switchTab({url:"/pages/template/index"})},gotoVoices:function(){uni.redirectTo({url:"/pages/template/voice"})},gotoTranscribe:function(){var t=this;this.$refs.recorder.open(),setTimeout((function(){t.drawProgress()}),50)},startRecording:function(){var t=this;this.recorder=window.Recorder({type:"wav",sampleRate:16e3,bitRate:16}),this.recorder.open((function(){t.isRecording=!0,t.started=!0,t.interval=setInterval((function(){t.duration<15?(t.duration++,t.progress=t.duration%60/15,t.drawProgress()):t.stopRecording()}),1e3),t.recorder.start()}),(function(e,i){t.$tip.confirm("录音失败".concat(e),!1)}))},stopRecording:function(){var t=this;this.recorder&&this.recorder.stop((function(e,i){t.isRecording=!1,t.started=!1,t.progress=0,clearInterval(t.interval),t.audioUrl=URL.createObjectURL(e),t.recorder.close(),t.recorderFile=new File([e],"recording.wav",{type:"audio/wav"})}),(function(e){t.$tip.confirm("停止失败".concat(e),!1)}))},drawProgress:function(){var t=this.ctx;t.clearRect(0,0,100,100),t.beginPath(),t.arc(50,50,40,0,2*Math.PI),t.setStrokeStyle("#eeeeee"),t.setLineWidth(4),t.stroke(),t.beginPath(),t.arc(50,50,40,-.5*Math.PI,2*this.progress*Math.PI-.5*Math.PI),t.setStrokeStyle("#00C6AD"),t.setLineWidth(4),t.stroke(),t.draw()},formatTime:function(t){var e=Math.floor(t/60).toString().padStart(2,"0"),i=(t%60).toString().padStart(2,"0");return"".concat(e,":").concat(i)},reRecord:function(){this.audioUrl=null,this.progress=0,this.duration=0,this.started=!1}},beforeDestroy:function(){this.stopAudio()}};e.default=n}}]);