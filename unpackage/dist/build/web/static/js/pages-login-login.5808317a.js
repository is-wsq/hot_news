(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-login-login"],{"4c3d":function(t,i,n){var o=n("c86c");i=o(!1),i.push([t.i,".login[data-v-3585a9a6]{position:relative;background-color:#000;height:100vh!important}.title[data-v-3585a9a6]{font-size:60px;font-weight:700;position:absolute;top:calc(50% - 50px);left:calc(50% - 63px)}.login[data-v-3585a9a6] .uni-forms-item{margin-bottom:20px}.login[data-v-3585a9a6] .uni-forms-item__label{font-size:14px;color:#fff}.login[data-v-3585a9a6] .uni-forms-item.is-direction-top .uni-forms-item__label{padding:0 0 6px!important}.logo-img[data-v-3585a9a6]{width:100%;position:relative}.login-box[data-v-3585a9a6]{position:absolute;bottom:0;width:100%;height:528px;background-color:#292929;border-top-left-radius:30px;border-top-right-radius:30px;padding:30px;display:flex;flex-direction:column;box-sizing:border-box}.welcome[data-v-3585a9a6]{font-size:22px;font-weight:700;margin-bottom:10px;text-align:center;color:#fff}.subtitle[data-v-3585a9a6]{font-size:14px;color:#bbb;margin-bottom:10px;text-align:center}.form-input[data-v-3585a9a6]{height:48px;padding:0 10px;border-radius:5px;box-sizing:border-box;background-color:#5f5f5f;color:#fff}.send-sms-button[data-v-3585a9a6]{position:absolute;top:0;right:12px;color:#fff;font-size:16px;line-height:48px}.forgot-password[data-v-3585a9a6]{font-size:14px;color:#bbb;cursor:pointer;margin:0 auto}.login-button[data-v-3585a9a6]{flex:1;height:50px;line-height:50px;background:#e99d42;color:#fff;font-size:16px;border-radius:10px}.signup-button[data-v-3585a9a6]{flex:1;height:50px;line-height:50px;background:#fff;color:#1e1f20;font-size:16px;border-radius:10px}.third[data-v-3585a9a6]{width:100%;height:50px;border-radius:10px;background-color:#393939;display:flex;align-items:center;justify-content:center}",""]),t.exports=i},"4ee8":function(t,i,n){"use strict";n.r(i);var o=n("d410"),e=n.n(o);for(var a in o)["default"].indexOf(a)<0&&function(t){n.d(i,t,(function(){return o[t]}))}(a);i["default"]=e.a},"7dc0":function(t,i,n){"use strict";n.d(i,"b",(function(){return e})),n.d(i,"c",(function(){return a})),n.d(i,"a",(function(){return o}));var o={uniForms:n("f529").default,uniFormsItem:n("79b6").default,uniIcons:n("00f9").default},e=function(){var t=this,i=t.$createElement,n=t._self._c||i;return n("v-uni-view",{staticClass:"login"},[n("v-uni-view",{staticClass:"logo-img"},[n("v-uni-image",{staticStyle:{width:"100%"},attrs:{src:"/static/login/bg-black.jpeg",mode:"widthFix"}}),n("v-uni-view",{staticClass:"title"},[n("span",{staticStyle:{color:"#fff"}},[t._v("奇")]),n("span",{staticStyle:{color:"#E1C59CD9","margin-left":"6px"}},[t._v("点")])])],1),n("v-uni-view",{staticClass:"login-box"},[n("v-uni-text",{staticClass:"welcome"},[t._v("欢迎回来 !")]),n("v-uni-text",{staticClass:"subtitle"},[t._v("登陆后继续")]),n("uni-forms",{ref:"loginForm",attrs:{"label-position":"top"}},[n("uni-forms-item",{attrs:{name:"phone",label:"手机号"}},[n("v-uni-input",{staticClass:"form-input",attrs:{type:"number"},model:{value:t.loginFormData.phone,callback:function(i){t.$set(t.loginFormData,"phone",i)},expression:"loginFormData.phone"}})],1),n("uni-forms-item",{staticStyle:{position:"relative"},attrs:{name:"password",label:0===t.loginType?"密码":"验证码"}},[0===t.loginType?n("v-uni-input",{staticClass:"form-input",attrs:{type:"text",password:!0},model:{value:t.loginFormData.password,callback:function(i){t.$set(t.loginFormData,"password",i)},expression:"loginFormData.password"}}):n("v-uni-input",{staticClass:"form-input",attrs:{type:"text",password:!0},model:{value:t.loginFormData.sms,callback:function(i){t.$set(t.loginFormData,"sms",i)},expression:"loginFormData.sms"}}),1===t.loginType?n("v-uni-view",{staticClass:"send-sms-button",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.onSMSSend.apply(void 0,arguments)}}},[t._v(t._s(t.getSendBtnText))]):t._e()],1)],1),n("v-uni-view",{staticStyle:{width:"100%",display:"flex","justify-content":"space-between"}},[n("v-uni-text",{staticClass:"forgot-password"},[t._v("忘记密码？")]),n("v-uni-text",{staticClass:"forgot-password",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.loginType=1-t.loginType}}},[t._v(t._s(0===t.loginType?"短信登陆":"密码登陆"))])],1),n("v-uni-view",{staticStyle:{display:"flex",gap:"30px",margin:"25px 0"}},[n("v-uni-button",{staticClass:"login-button",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.login.apply(void 0,arguments)}}},[t._v("登陆")]),n("v-uni-button",{staticClass:"signup-button",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.gotoRegister.apply(void 0,arguments)}}},[t._v("创建账户")])],1),n("v-uni-view",{staticStyle:{display:"flex","margin-top":"10px","justify-content":"center",gap:"40px"}},[n("v-uni-view",{staticClass:"third",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.wxLogin.apply(void 0,arguments)}}},[n("v-uni-view",{staticStyle:{color:"#fff","margin-right":"5px"}},[t._v("微信授权登陆")]),n("uni-icons",{attrs:{type:"weixin",size:"25",color:"#fff"}})],1)],1)],1)],1)},a=[]},"890f":function(t,i,n){"use strict";var o=n("9a38"),e=n.n(o);e.a},"9a38":function(t,i,n){var o=n("4c3d");o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);var e=n("967d").default;e("801a47b2",o,!0,{sourceMap:!1,shadowMode:!1})},c6d1:function(t,i,n){"use strict";n.r(i);var o=n("7dc0"),e=n("4ee8");for(var a in e)["default"].indexOf(a)<0&&function(t){n.d(i,t,(function(){return e[t]}))}(a);n("890f");var s=n("828b"),r=Object(s["a"])(e["default"],o["b"],o["c"],!1,null,"3585a9a6",null,!1,o["a"],void 0);i["default"]=r.exports},d410:function(t,i,n){"use strict";n("6a54"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0,n("23f4"),n("7d2f"),n("5c47"),n("9c4e"),n("ab80"),n("0506"),n("c223"),n("a1c1"),n("d4b5");var o={data:function(){return{safe:uni.getSystemInfoSync().safeArea,loginType:0,loginFormData:{phone:"",password:"",sms:""},registerFormData:{phone:"",password:"",rePassword:""},smsCountDown:0,type:"",path:""}},computed:{isSendSMSEnable:function(){return this.smsCountDown<=0},getSendBtnText:function(){return this.smsCountDown>0?this.smsCountDown+"秒后发送":"发送验证码"}},onLoad:function(t){this.type=t.type,this.path=t.path},methods:{login:function(){var t=new RegExp(/^[1]([3-9])[0-9]{9}$/);this.loginFormData.phone&&0!==this.loginFormData.phone.length?t.test(this.loginFormData.phone)?0===this.loginType?this.onPasswordLogin():this.onSMSLogin():this.$tip.confirm("请输入正确的手机号",!1):this.$tip.confirm("请填写手机号",!1)},gotoRegister:function(){uni.redirectTo({url:"/pages/login/register"})},onPasswordLogin:function(){var t=this;if(this.loginFormData.password){var i={phone:this.loginFormData.phone,password:this.loginFormData.password};this.$http.post("/user/login",i).then((function(i){"success"===i.status?(uni.setStorageSync("userId",i.data.user_id),"switchTab"===t.type?uni.switchTab({url:t.path}):uni.redirectTo({url:t.path})):t.$tip.confirm(i.message,!1)}))}else this.$tip.confirm("请输入密码",!1)},onSMSLogin:function(){var t=this;if(this.loginFormData.sms&&0!==this.loginFormData.sms.length){var i={phone:this.loginFormData.phone,code:this.loginFormData.sms,usage:"login"};this.$http.post("/sms/verify",i).then((function(i){"success"===i.status?(uni.setStorageSync("userId",i.data.user_id),"switchTab"===t.type?uni.switchTab({url:t.path}):uni.redirectTo({url:t.path})):t.$tip.confirm(i.message,!1)}))}else this.$tip.confirm("请填短信验证码",!1)},onSMSSend:function(){var t=this;if(this.isSendSMSEnable){var i=new RegExp(/^[1]([3-9])[0-9]{9}$/);if(this.loginFormData.phone&&0!==this.loginFormData.phone.length)if(i.test(this.loginFormData.phone)){var n={phone:this.loginFormData.phone,usage:"login"};this.$http.post("/sms/send",n).then((function(i){"success"===i.status?(t.smsCountDown=60,t.startSMSTimer(),t.$tip.confirm("短信验证码发送成功",!1)):t.$tip.confirm(i.message,!1)}))}else this.$tip.confirm("请输入正确的手机号",!1);else this.$tip.confirm("请填写手机号",!1)}},startSMSTimer:function(){var t=this;this.smsCountInterval=setInterval((function(){t.smsCountDown--,t.smsCountDown<=0&&clearInterval(t.smsCountInterval)}),1e3)},resetData:function(){this.loginType=0,this.loginFormData={phone:"",password:"",sms:""}},isWeChat:function(){return/MicroMessenger/i.test(navigator.userAgent)},getCurrentUrl:function(){return location.href.split("#")[0]},wxLogin:function(){if(this.isWeChat()){var t=encodeURIComponent("".concat(this.getCurrentUrl(),"#/pages/login/auth-callback")),i="https://open.weixin.qq.com/connect/oauth2/authorize?appid=".concat("wx48d2e02bf10f849c","&redirect_uri=").concat(t,"&response_type=code&scope=").concat("snsapi_userinfo","&state=").concat("xyz123","#wechat_redirect");uni.setStorageSync("authorized",!0),uni.redirectTo({url:i})}else this.$tip.confirm("需要在微信环境下才能使用",!1)},getUrlCode:function(t){return decodeURIComponent((new RegExp("[?|&]"+t+"=([^&;]+?)(&|#|;|$)").exec(location.href)||[,""])[1].replace(/\+/g,"%20"))||null},checkWeChatCode:function(){var t=this.getUrlCode("code");t&&uni.getStorageSync("authorized")&&(uni.removeStorageSync("authorized"),this.loginByCode(t))},loginByCode:function(t){var i=this;this.$http.get("/user/wx/auth",{code:t}).then((function(t){if("success"===t.status){uni.setStorageSync("userId",t.data.user_id);var n=location.origin+location.pathname;history.replaceState({},"",n),"switchTab"===i.type?uni.switchTab({url:i.path}):uni.redirectTo({url:i.path})}else i.$tip.confirm(t.message,!1)})).catch((function(t){i.$tip.confirm(JSON.stringify(t),!1)}))}}};i.default=o}}]);