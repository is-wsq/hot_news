(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-template-voice"],{"4c07":function(t,i,e){"use strict";e("6a54");var a=e("f5bd").default;Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0,e("8f71"),e("bf0f"),e("a578"),e("2797"),e("aa9c");var s=a(e("9b1b")),n=e("8f59"),o={name:"voice",data:function(){return{heightStyle:0,systems:[],clones:[],audioCtx:null,audioCtxId:null,dotCount:1,dotTimer:null,dot:"."}},computed:(0,s.default)((0,s.default)({},(0,n.mapGetters)("task",["allTasks"])),{},{voiceTasks:function(){return this.allTasks.filter((function(t){return"voice"===t.type}))}}),watch:{voiceTasks:{handler:function(){this.queryVoices()},deep:!0}},mounted:function(){this.queryVoices(),this.voiceTasks.length>0&&this.startDotAnimation(),this.heightStyle=(uni.getSystemInfoSync().safeArea.height-200)/2},beforeDestroy:function(){clearInterval(this.dotTimer),this.stopPreviewAudio()},methods:{startDotAnimation:function(){var t=this;this.dotTimer=setInterval((function(){t.dotCount=t.dotCount%3+1,t.dot=".".repeat(t.dotCount)}),1e3)},queryVoices:function(){var t=this;this.systems=[],this.clones=[],this.$http.get("/timbres/query/user",{user_id:uni.getStorageSync("userId")}).then((function(i){"success"===i.status?i.data.forEach((function(i){"system"===i.type?t.systems.push(i):t.clones.push(i)})):t.$tip.confirm(i.message,!1)}))},previewAudio:function(t){var i=this;this.audioCtxId!==t.id?(this.audioCtx&&this.stopPreviewAudio(),this.audioCtx=uni.createInnerAudioContext(),this.audioCtx.src=t.filepath,this.audioCtx.autoplay=!0,this.audioCtx.play(),this.audioCtx.onPlay((function(){i.audioCtxId=t.id})),this.audioCtx.onEnded((function(){i.stopPreviewAudio()}))):this.stopPreviewAudio()},stopPreviewAudio:function(){this.audioCtx&&(this.audioCtx.pause(),this.audioCtx.destroy(),this.audioCtx=null,this.audioCtxId=null)},back:function(){uni.redirectTo({url:"/pages/template/voicesClone"})}}};i.default=o},"65ce":function(t,i,e){"use strict";e.d(i,"b",(function(){return s})),e.d(i,"c",(function(){return n})),e.d(i,"a",(function(){return a}));var a={uniIcons:e("00f9").default},s=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("v-uni-view",{staticClass:"pages voice"},[e("v-uni-view",{staticClass:"nav-bar-header"},[e("uni-icons",{staticClass:"nav-bar-back",attrs:{type:"left",size:"21",color:"#ffffff"},on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.back.apply(void 0,arguments)}}}),e("v-uni-view",{staticClass:"nav-bar-title"},[t._v("音色列表")])],1),e("v-uni-view",{staticStyle:{"font-size":"18px",color:"#ffffff","margin-bottom":"15px"}},[t._v("系统音色")]),e("v-uni-view",{staticClass:"voice-list",style:{height:t.heightStyle+"px"}},t._l(t.systems,(function(i){return e("v-uni-view",{key:i.id,staticClass:"voice-item",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.previewAudio(i)}}},[e("v-uni-image",{class:{"active-item":t.audioCtxId===i.id},staticStyle:{width:"80px",height:"80px","border-radius":"50%"},attrs:{src:i.avatar}}),e("v-uni-view",{staticClass:"voice-name",style:{color:t.audioCtxId===i.id?"#e99d42":"#ffffff"}},[t._v(t._s(i.name))])],1)})),1),e("v-uni-view",{staticStyle:{"font-size":"18px",color:"#ffffff",margin:"15px 0"}},[t._v("我的音色")]),e("v-uni-view",{staticClass:"voice-list",style:{height:t.heightStyle+"px"}},[t._l(t.voiceTasks,(function(i){return e("v-uni-view",{key:i.id,staticClass:"voice-item"},[e("v-uni-view",{staticClass:"image-wrapper shining"},[e("v-uni-image",{staticStyle:{width:"80px",height:"80px","border-radius":"50%"},attrs:{src:"/static/img/voice-loading.png"}}),e("v-uni-view",{staticClass:"shine-layer"}),e("v-uni-view",{staticClass:"loading-title"},[e("v-uni-view",{staticStyle:{"font-size":"14px"}},[t._v("克隆中")]),e("v-uni-view",{staticClass:"dot"},[t._v(t._s(t.dot))])],1)],1),e("v-uni-view",{staticClass:"voice-name"},[t._v(t._s(i.name))])],1)})),t._l(t.clones,(function(i){return e("v-uni-view",{key:i.id,staticClass:"voice-item",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.previewAudio(i)}}},[e("v-uni-image",{class:{"active-item":t.audioCtxId===i.id},staticStyle:{width:"80px",height:"80px","border-radius":"50%"},attrs:{src:i.avatar}}),e("v-uni-view",{staticClass:"voice-name",style:{color:t.audioCtxId===i.id?"#e99d42":"#ffffff"}},[t._v(t._s(i.name))])],1)}))],2)],1)},n=[]},"89ef":function(t,i,e){"use strict";e.r(i);var a=e("4c07"),s=e.n(a);for(var n in a)["default"].indexOf(n)<0&&function(t){e.d(i,t,(function(){return a[t]}))}(n);i["default"]=s.a},a578:function(t,i,e){"use strict";var a=e("8bdb"),s=e("f298");a({target:"String",proto:!0},{repeat:s})},ac26:function(t,i,e){"use strict";e.r(i);var a=e("65ce"),s=e("89ef");for(var n in s)["default"].indexOf(n)<0&&function(t){e.d(i,t,(function(){return s[t]}))}(n);e("c7ba");var o=e("828b"),r=Object(o["a"])(s["default"],a["b"],a["c"],!1,null,"4d6f0696",null,!1,a["a"],void 0);i["default"]=r.exports},b74b:function(t,i,e){var a=e("e0cc");a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var s=e("967d").default;s("4a891037",a,!0,{sourceMap:!1,shadowMode:!1})},c7ba:function(t,i,e){"use strict";var a=e("b74b"),s=e.n(a);s.a},e0cc:function(t,i,e){var a=e("c86c");i=a(!1),i.push([t.i,".voice[data-v-4d6f0696]{height:100vh;color:#fff}.voice-list[data-v-4d6f0696]{display:grid;grid-template-columns:repeat(auto-fill,minmax(80px,1fr));grid-auto-rows:110px;gap:20px;overflow-y:auto}.voice-item[data-v-4d6f0696]{text-align:center}.loading-title[data-v-4d6f0696]{position:absolute;color:#fff;font-size:14px;width:100%;text-align:center;top:50%;-webkit-transform:translateY(-50%);transform:translateY(-50%);display:flex;align-items:center;justify-content:center}.dot[data-v-4d6f0696]{width:20px;text-align:left;margin-left:5px;font-size:16px;line-height:40px}.voice-name[data-v-4d6f0696]{width:100%;text-align:center;font-size:14px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.active-item[data-v-4d6f0696]{border:1px solid #e99d42}",""]),t.exports=i},f298:function(t,i,e){"use strict";var a=e("497b"),s=e("9e70"),n=e("862c"),o=RangeError;t.exports=function(t){var i=s(n(this)),e="",r=a(t);if(r<0||r===1/0)throw new o("Wrong number of repetitions");for(;r>0;(r>>>=1)&&(i+=i))1&r&&(e+=i);return e}}}]);