(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-home-custom"],{"024c":function(t,e,i){"use strict";var n=i("f4b8"),o=i.n(n);o.a},"66d3":function(t,e,i){"use strict";i.d(e,"b",(function(){return o})),i.d(e,"c",(function(){return s})),i.d(e,"a",(function(){return n}));var n={uniIcons:i("00f9").default,uniPopup:i("3182").default},o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",{staticClass:"pages custom"},[i("v-uni-view",{staticClass:"nav-bar-header"},[i("uni-icons",{staticClass:"nav-bar-back",attrs:{type:"left",size:"21",color:"#ffffff"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.back.apply(void 0,arguments)}}}),i("v-uni-view",{staticClass:"nav-bar-title"},[t._v("口播文案")])],1),i("v-uni-view",{staticClass:"custom-content"},[i("v-uni-view",{staticStyle:{color:"#ffffff",display:"flex","justify-content":"center","align-items":"center"}},[t.isEdit?i("v-uni-input",{staticStyle:{height:"23px","line-height":"23px","text-align":"center"},attrs:{type:"text",focus:t.focus},on:{blur:function(e){arguments[0]=e=t.$handleEvent(e),t.isEdit=!1}},model:{value:t.title,callback:function(e){t.title=e},expression:"title"}}):i("v-uni-view",{staticStyle:{height:"23px","line-height":"23px"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.edit.apply(void 0,arguments)}}},[t._v(t._s(t.title?t.title:"请输入标题"))])],1),i("v-uni-view",{staticClass:"custom-card"},[i("v-uni-textarea",{staticClass:"custom-script",attrs:{type:"text","placeholder-style":"color:#9A9A9A",placeholder:"请输入文案内容",maxlength:-1},model:{value:t.script,callback:function(e){t.script=e},expression:"script"}}),i("v-uni-view",{staticStyle:{height:"20px","text-align":"end"}},[i("v-uni-image",{staticClass:"custom-icon",attrs:{src:"/static/copy_icon.png"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.copy.apply(void 0,arguments)}}})],1)],1)],1),i("v-uni-view",{staticClass:"warning"},[t._v("内容禁止从事违法活动")]),i("v-uni-view",{staticClass:"custom-setting"},[i("v-uni-view",{staticClass:"setting-item"},[i("v-uni-view",{staticStyle:{color:"#E5E5E5"}},[t._v("声音选择")]),i("v-uni-view",{staticClass:"setting-name",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.$refs.voicePopup.open.apply(void 0,arguments)}}},[t._v(t._s(t.voice.name))]),i("uni-icons",{attrs:{type:"right",size:"20",color:"#E5E5E5;"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.$refs.voicePopup.open.apply(void 0,arguments)}}})],1),i("v-uni-view",{staticClass:"setting-item"},[i("v-uni-view",{staticStyle:{color:"#E5E5E5"}},[t._v("形象选择")]),i("v-uni-view",{staticClass:"setting-name",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.$refs.figurePopup.open.apply(void 0,arguments)}}},[t._v(t._s(t.figure.name))]),i("uni-icons",{attrs:{type:"right",size:"20",color:"#E5E5E5;"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.$refs.figurePopup.open.apply(void 0,arguments)}}})],1)],1),i("v-uni-view",{staticStyle:{position:"relative",width:"250px",margin:"0 auto"}},[i("v-uni-button",{staticClass:"custom-btn",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.generateVideo.apply(void 0,arguments)}}},[t._v("口播视频生成")]),i("v-uni-view",{staticClass:"word-count"},[i("uni-icons",{attrs:{fontFamily:"CustomFont",color:"#ffffff",size:"18"}},[t._v(t._s(""))]),i("v-uni-view",{staticStyle:{"margin-left":"3px",color:"#ffffff","font-size":"14px"}},[t._v(t._s(t.scriptLengthInHundredths))])],1)],1),i("uni-popup",{ref:"voicePopup",attrs:{type:"bottom","background-color":"#292929",borderRadius:"12px 12px 0 0"},on:{maskClick:function(e){arguments[0]=e=t.$handleEvent(e),t.closeVoicePopup.apply(void 0,arguments)}}},[i("v-uni-view",{staticClass:"popup-content"},[i("v-uni-view",{staticClass:"popup-title"},[i("v-uni-view",{staticStyle:{color:"#ffffff","font-size":"16px"}},[t._v("声音")])],1),i("v-uni-view",{staticClass:"voice-content"},t._l(t.voices,(function(e,n){return i("v-uni-view",{key:e.id,staticStyle:{flex:"none","text-align":"center"},on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.selectedVoice=e}}},[i("v-uni-view",{staticClass:"voice-item",style:{border:e.id===t.selectedVoice.id?"2px solid #e99d42":""}},[t.testAudioIndex!==n?i("uni-icons",{staticClass:"off-on",attrs:{fontFamily:"CustomFont",size:"20",color:"#ffffff"},on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.previewAudio(e,n)}}},[t._v(t._s(""))]):i("uni-icons",{staticClass:"off-on",attrs:{fontFamily:"CustomFont",size:"20",color:"#ffffff"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.stopPreviewAudio.apply(void 0,arguments)}}},[t._v(t._s(""))])],1),i("v-uni-view",{staticStyle:{"margin-top":"10px","font-size":"14px",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap",width:"80px"},style:{color:e.id===t.selectedVoice.id?"#e99d42":"#ffffff"}},[t._v(t._s(e.name))])],1)})),1),i("v-uni-button",{staticClass:"custom-btn",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.voiceSure.apply(void 0,arguments)}}},[t._v("确定")])],1)],1),i("uni-popup",{ref:"figurePopup",attrs:{type:"bottom","background-color":"#292929",borderRadius:"12px 12px 0 0"}},[i("v-uni-view",{staticClass:"popup-content"},[i("v-uni-view",{staticClass:"popup-title"},[i("v-uni-view",{staticStyle:{color:"#ffffff","font-size":"16px"}},[t._v("形象")])],1),i("v-uni-view",{staticClass:"figure-content"},t._l(t.figures,(function(e){return i("v-uni-view",{key:e.id,staticStyle:{flex:"none","text-align":"center"},on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.selectedFigure=e}}},[i("v-uni-image",{staticClass:"figure-item",style:{border:e.id===t.selectedFigure.id?"2px solid #e99d42":""},attrs:{src:e.picture}}),i("v-uni-view",{staticStyle:{"margin-top":"10px","font-size":"14px",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap",width:"100px"},style:{color:e.id===t.selectedFigure.id?"#e99d42":"#ffffff"}},[t._v(t._s(e.name))])],1)})),1),i("v-uni-button",{staticClass:"custom-btn",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.figureSure.apply(void 0,arguments)}}},[t._v("确定")])],1)],1)],1)},s=[]},"6d6a":function(t,e,i){var n=i("c86c");e=n(!1),e.push([t.i,"@font-face{font-family:CustomFont;src:url(/static/iconfont.ttf)}.custom[data-v-7d5048e4]{height:100vh}.custom-content[data-v-7d5048e4]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:calc(100% - 235px)}.custom-card[data-v-7d5048e4]{width:100%;height:calc(100% - 30px);margin-top:10px;border-radius:20px;background-color:#303030;padding:14px;box-sizing:border-box}.custom-script[data-v-7d5048e4]{height:calc(100% - 20px);line-height:23px;width:100%;overflow-y:auto;font-size:14px;color:#9a9a9a}.custom-icon[data-v-7d5048e4]{width:18px;height:18px;margin-top:5px;margin-right:3px}.warning[data-v-7d5048e4]{color:#9a9a9a;font-size:14px;margin:10px 0}.custom-setting[data-v-7d5048e4]{margin-bottom:10px;margin-left:10px}.setting-item[data-v-7d5048e4]{color:#fff;font-size:16px;height:35px;line-height:35px;display:flex;align-items:center}.setting-name[data-v-7d5048e4]{flex:1;overflow-x:auto;white-space:nowrap;margin-right:20px;text-align:right;color:#e5e5e5}.custom-btn[data-v-7d5048e4]{background-color:#e99d42;width:250px;margin:0 auto;font-size:16px;border-radius:10px;color:#101010}.word-count[data-v-7d5048e4]{position:absolute;top:0;right:20px;height:40px;display:flex;align-items:center}.popup-content[data-v-7d5048e4]{background-color:#292929;border-top-left-radius:12px;border-top-right-radius:12px;padding:20px}.popup-title[data-v-7d5048e4]{display:flex;align-items:center;justify-content:center;position:relative}.popup-close[data-v-7d5048e4]{position:absolute;top:5px;right:0;color:#fff}.voice-content[data-v-7d5048e4]{width:100%;height:220px;display:flex;gap:20px;overflow-x:auto;flex-wrap:nowrap;align-items:center}.voice-item[data-v-7d5048e4]{width:80px;height:80px;border-radius:50%;background-color:#9a9a9a;position:relative}.off-on[data-v-7d5048e4]{height:20px;width:20px;position:absolute;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}.figure-content[data-v-7d5048e4]{width:100%;height:250px;display:flex;gap:20px;overflow-x:auto;flex-wrap:nowrap;align-items:center}.figure-item[data-v-7d5048e4]{width:90px;height:120px;border-radius:12px}",""]),t.exports=e},"8c11":function(t,e,i){"use strict";i.r(e);var n=i("d05e"),o=i.n(n);for(var s in n)["default"].indexOf(s)<0&&function(t){i.d(e,t,(function(){return n[t]}))}(s);e["default"]=o.a},d05e:function(t,e,i){"use strict";i("6a54"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,i("c223"),i("c9b5"),i("bf0f"),i("ab80");var n={name:"Detail",data:function(){return{userId:"",isEdit:!1,focus:!1,title:"",script:"",voices:[],voice:{},selectedVoice:{},figures:[],figure:{},selectedFigure:{},testAudioContext:null,testAudioIndex:null}},computed:{scriptLengthInHundredths:function(){return Math.ceil(this.script.length/100)}},mounted:function(){this.userId=uni.getStorageSync("userId"),this.queryVoices(),this.queryFigures()},methods:{queryFigures:function(){var t=this;this.$http.get("/figure/query/user",{user_id:this.userId}).then((function(e){"success"===e.status?(t.figures=e.data,t.figures.length>0&&(t.figure=t.figures[0],t.selectedFigure=t.figures[0])):t.$tip.confirm(e.message,!1)}))},queryVoices:function(){var t=this;this.$http.get("/timbres/query/user",{user_id:this.userId}).then((function(e){"success"===e.status?(t.voices=e.data,t.voices.length>0&&(t.voice=t.voices[0],t.selectedVoice=t.voices[0])):t.$tip.confirm(e.message,!1)}))},previewAudio:function(t,e){var i=this;this.testAudioContext&&this.stopPreviewAudio(),this.testAudioContext=uni.createInnerAudioContext(),this.testAudioContext.src=t.filepath,this.testAudioContext.autoplay=!0,this.testAudioContext.play(),this.testAudioContext.onPlay((function(){i.testAudioIndex=e})),this.testAudioContext.onEnded((function(){i.stopPreviewAudio()}))},stopPreviewAudio:function(){this.testAudioContext.pause(),this.testAudioContext.destroy(),this.testAudioContext=null,this.testAudioIndex=null},voiceSure:function(){this.testAudioContext&&this.stopPreviewAudio(),this.voice=this.selectedVoice,this.$refs.voicePopup.close()},closeVoicePopup:function(){this.testAudioContext&&this.stopPreviewAudio(),this.$refs.voicePopup.close()},figureSure:function(){this.figure=this.selectedFigure,this.$refs.figurePopup.close()},copy:function(){var t=this;uni.setClipboardData({data:t.script,showToast:!1,success:function(){t.$tip.confirm("复制成功",!1)}})},generateVideo:function(){var t=this;if(""!==this.title)if(""!==this.script){var e={name:this.title,type:"video",id:this.generateUniqueId()};this.$store.dispatch("task/addTask",e),this.$tip.confirm("已创建口播视频生成任务\n《".concat(this.title,".mp4》"),!1).then((function(t){uni.switchTab({url:"/pages/template/index"})}));var i={text:this.script,user_id:this.userId,voice_id:this.voice.voice_id,video_id:this.figure.video_id,filename:this.title};this.$http.post("/figure/generate_video",i,18e5).then((function(i){t.$store.dispatch("task/removeTask",e.id),"success"===i.status?t.$tip.confirm("口播视频".concat(e.name,"生成任务成功"),!1):t.$tip.confirm("口播视频".concat(e.name,"生成任务失败,").concat(i.message),!1)}))}else this.$tip.confirm("请输入文案内容",!1);else this.$tip.confirm("请输入标题",!1)},generateUniqueId:function(){return Date.now()+Math.random().toString(36).substr(2,16)},back:function(){uni.hideKeyboard(),setTimeout((function(){uni.redirectTo({url:"/pages/home/search"})}),100)},edit:function(){this.isEdit=!0,this.focus=!0}}};e.default=n},d760:function(t,e,i){"use strict";i.r(e);var n=i("66d3"),o=i("8c11");for(var s in o)["default"].indexOf(s)<0&&function(t){i.d(e,t,(function(){return o[t]}))}(s);i("024c");var a=i("828b"),c=Object(a["a"])(o["default"],n["b"],n["c"],!1,null,"7d5048e4",null,!1,n["a"],void 0);e["default"]=c.exports},f4b8:function(t,e,i){var n=i("6d6a");n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var o=i("967d").default;o("3ae26404",n,!0,{sourceMap:!1,shadowMode:!1})}}]);