(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-template-figure"],{"0821":function(e,t,i){var n=i("c86c");t=n(!1),t.push([e.i,".loading-container[data-v-610b468f]{position:fixed;top:0;left:0;width:100%;height:100%;display:flex;justify-content:center;align-items:center;background-color:rgba(0,0,0,.5);z-index:9999}.loading-wrapper[data-v-610b468f]{display:flex;flex-direction:column;align-items:center;justify-content:center;max-width:180px;background-color:rgba(0,0,0,.5);border-radius:10px;padding:20px}.loading-video[data-v-610b468f]{width:100px;height:85px}.loading-text[data-v-610b468f]{color:#fff;margin-top:15px;font-size:16px}",""]),e.exports=t},1173:function(e,t,i){"use strict";i.r(t);var n=i("c402"),a=i.n(n);for(var s in n)["default"].indexOf(s)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(s);t["default"]=a.a},"13af":function(e,t,i){"use strict";var n=i("5ba5"),a=i.n(n);a.a},"19bc":function(e,t,i){"use strict";i.r(t);var n=i("2c99"),a=i.n(n);for(var s in n)["default"].indexOf(s)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(s);t["default"]=a.a},"25f0":function(e,t,i){var n=i("c86c");t=n(!1),t.push([e.i,".figure-type-name[data-v-281c9d21]{color:#fff;font-size:16px;line-height:50px}.figure-list[data-v-281c9d21]{height:calc(50% - 90px);background-color:#292929;border-radius:10px;padding:10px;box-sizing:border-box;overflow:auto;display:grid;grid-template-columns:repeat(auto-fill,minmax(150px,1fr));grid-auto-rows:90px;gap:20px}.figure-item[data-v-281c9d21]{display:flex;border:1px solid #3a3a3a;padding:10px;border-radius:10px;box-sizing:border-box;flex:1;height:90px}.active-item[data-v-281c9d21]{border:1px solid #e99d42}.figure-avatar[data-v-281c9d21]{width:60px;height:70px;border-radius:10px}.clone-figure-icon[data-v-281c9d21]{border:1px solid #e99d42;line-height:70px}.figure-name[data-v-281c9d21]{margin-left:10px;flex:1;color:#fff;font-size:14px;line-height:70px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.preview-content[data-v-281c9d21]{background-color:#292929;padding:20px 0;box-sizing:border-box}.preview-title[data-v-281c9d21]{display:flex;align-items:center;justify-content:center;position:relative;margin-bottom:20px}.preview-close[data-v-281c9d21]{position:absolute;top:5px;right:10px;color:#fff}.play-icon[data-v-281c9d21]{height:20px;width:20px;position:absolute;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}.clone-content[data-v-281c9d21]{background:#fff;border-radius:11px;padding-top:20px;box-sizing:border-box}.clone-title[data-v-281c9d21]{font-size:16px;font-weight:500;color:#909399;text-align:center}.file-name[data-v-281c9d21]{font-size:14px;line-height:36px;flex:1;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.clone-btn[data-v-281c9d21]{flex:1;height:50px;line-height:50px;text-align:center;font-size:16px;border-radius:0 0 0 11px;border-top:1px solid #f5f5f5}",""]),e.exports=t},"2c99":function(e,t,i){"use strict";i("6a54"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n={props:{text:{type:String,default:"Loading..."}},methods:{playVideo:function(){this.$refs.video.play()}}};t.default=n},"5ba5":function(e,t,i){var n=i("25f0");n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);var a=i("967d").default;a("525619c8",n,!0,{sourceMap:!1,shadowMode:!1})},"5e39":function(e,t,i){"use strict";var n=i("c7d9"),a=i.n(n);a.a},6794:function(e,t,i){"use strict";i.d(t,"b",(function(){return a})),i.d(t,"c",(function(){return s})),i.d(t,"a",(function(){return n}));var n={uniIcons:i("00f9").default,uniPopup:i("3182").default},a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-uni-view",{staticClass:"pages figure",style:{height:e.safeAreaHeight+"px"}},[i("v-uni-view",{staticClass:"nav-bar-header"},[i("uni-icons",{staticClass:"nav-bar-back",attrs:{type:"left",size:"21",color:"#ffffff"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.back.apply(void 0,arguments)}}}),i("v-uni-view",{staticClass:"nav-bar-title"},[e._v("形象列表")])],1),i("v-uni-view",{staticClass:"figure-type-name"},[e._v("系统形象")]),i("v-uni-view",{staticClass:"figure-list"},e._l(e.systems,(function(t){return i("v-uni-view",{key:t.id,staticClass:"figure-item",class:{"active-item":e.selectedFigure.id===t.id},on:{click:function(i){arguments[0]=i=e.$handleEvent(i),e.previewFigure(t)}}},[i("v-uni-image",{staticClass:"figure-avatar",attrs:{src:t.picture}}),i("v-uni-view",{staticClass:"figure-name"},[e._v(e._s(t.name))])],1)})),1),i("v-uni-view",{staticClass:"figure-type-name"},[e._v("克隆形象")]),i("v-uni-view",{staticClass:"figure-list"},[i("v-uni-view",{staticClass:"figure-item",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.cloneFigure.apply(void 0,arguments)}}},[i("uni-icons",{staticClass:"figure-avatar clone-figure-icon",attrs:{type:"plusempty",size:"25",color:"#e99d42"}}),i("v-uni-view",{staticClass:"figure-name",staticStyle:{color:"#e99d42 !important"}},[e._v("克隆形象")])],1),e._l(e.clones,(function(t){return i("v-uni-view",{key:t.id,staticClass:"figure-item",class:{"figure-item":e.selectedFigure.id===t.id},on:{click:function(i){arguments[0]=i=e.$handleEvent(i),e.previewFigure(t)}}},[i("v-uni-image",{staticClass:"figure-avatar",attrs:{src:t.picture}}),i("v-uni-view",{staticClass:"figure-name"},[e._v(e._s(t.name))])],1)}))],2),i("uni-popup",{ref:"previewPopup",attrs:{"mask-click":!1,type:"bottom"}},[i("v-uni-view",{staticClass:"preview-content",style:{height:e.safeAreaHeight+"px"}},[i("v-uni-view",{staticClass:"preview-title"},[i("v-uni-view",{staticStyle:{color:"#ffffff","font-size":"16px"}},[e._v("[ "+e._s(e.selectedFigure.name)+" ] 形象预览")]),i("uni-icons",{staticClass:"preview-close",attrs:{type:"closeempty",size:"20",color:"#ffffff"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.popupClose.apply(void 0,arguments)}}})],1),i("v-uni-view",{staticStyle:{height:"calc(100% - 30px)",position:"relative"}},[i("uni-icons",{staticClass:"preview-close",attrs:{type:"closeempty",size:"20",color:"#ffffff"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.popupClose.apply(void 0,arguments)}}}),i("v-uni-video",{ref:"video",staticStyle:{width:"100%",height:"100%"},attrs:{src:e.selectedFigure.filepath,controls:!1,"show-center-play-btn":!1}}),e.isPlaying?e._e():i("uni-icons",{staticClass:"play-icon",attrs:{"custom-prefix":"iconfont",type:"icon-play",size:"20",color:"#ffffff"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.controlVideo.apply(void 0,arguments)}}})],1)],1)],1),i("uni-popup",{ref:"clonePopup",staticStyle:{width:"100%"},attrs:{"mask-click":!1,type:"center"}},[i("v-uni-view",{staticClass:"clone-content",style:{width:.8*e.safeAreaWidth+"px"}},[i("v-uni-view",{staticClass:"clone-title"},[e._v("克隆形象")]),i("v-uni-view",{staticStyle:{padding:"30px","box-sizing":"border-box"}},[e.selectedFile?i("v-uni-view",{staticStyle:{display:"flex"}},[i("v-uni-view",{staticClass:"file-name"},[e._v(e._s(e.selectedFile.name))]),i("uni-icons",{staticStyle:{"margin-left":"10px","line-height":"38px"},attrs:{type:"trash-filled",size:"20",color:"#9a9a9a"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.selectedFile=null}}})],1):i("v-uni-view",{staticStyle:{"text-align":"center"}},[i("v-uni-button",{staticStyle:{"font-size":"14px"},attrs:{size:"mini"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.selectFile.apply(void 0,arguments)}}},[e._v("选择文件")])],1),i("v-uni-view",{staticStyle:{"margin-top":"10px",display:"flex","align-items":"center"}},[i("v-uni-checkbox-group",{on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.cloneSound=!e.cloneSound}}},[i("v-uni-checkbox",{staticStyle:{transform:"scale(0.7)"},attrs:{color:"#42B983"}})],1),i("v-uni-view",{staticStyle:{"font-size":"14px"}},[e._v("同时克隆声音")])],1)],1),i("v-uni-view",{staticStyle:{display:"flex"}},[i("v-uni-view",{staticClass:"clone-btn",staticStyle:{"border-right":"1px solid #f5f5f5"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.clonePopupClose.apply(void 0,arguments)}}},[e._v("取消")]),i("v-uni-view",{staticClass:"clone-btn",staticStyle:{color:"#007aff"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.clone.apply(void 0,arguments)}}},[e._v("克隆")])],1)],1)],1),e.isLoading?i("loading-video",{ref:"loadingVideo",attrs:{text:"视频克隆中..."}}):e._e()],1)},s=[]},"87c3":function(e,t,i){"use strict";i.r(t);var n=i("d095"),a=i("19bc");for(var s in a)["default"].indexOf(s)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(s);i("5e39");var o=i("828b"),c=Object(o["a"])(a["default"],n["b"],n["c"],!1,null,"610b468f",null,!1,n["a"],void 0);t["default"]=c.exports},c402:function(e,t,i){"use strict";i("6a54");var n=i("f5bd").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i("bf0f"),i("2797"),i("aa9c");var a=n(i("87c3")),s={name:"Figure",components:{LoadingVideo:a.default},data:function(){return{safeAreaHeight:uni.getSystemInfoSync().safeArea.height,safeAreaWidth:uni.getSystemInfoSync().safeArea.width,systems:[],clones:[],selectedFigure:{},src:"https://qiniu-web-assets.dcloud.net.cn/unidoc/zh/2minute-demo.mp4",isPlaying:!1,cloneSound:!1,selectedFile:null,isLoading:!1}},mounted:function(){this.queryFigures()},methods:{queryFigures:function(){var e=this;this.systems=[],this.clones=[],this.$http.get("/figure/query/user",{user_id:uni.getStorageSync("userId")}).then((function(t){"success"===t.status?t.data.forEach((function(t){"system"===t.type?e.systems.push(t):e.clones.push(t)})):e.$tip.toast(t.message)}))},previewFigure:function(e){"success"===e.status?(this.selectedFigure=e,this.$refs.previewPopup.open()):this.$tip.toast("形象还未克隆完成，暂时无法预览")},controlVideo:function(){this.$refs.video.play(),this.isPlaying=!0},popupClose:function(){this.isPlaying=!1,this.$refs.video.pause(),this.$refs.previewPopup.close()},cloneFigure:function(){this.$refs.clonePopup.open()},selectFile:function(){var e=this;uni.chooseFile({count:1,success:function(t){console.log(t),e.selectedFile=t.tempFiles[0]}})},clone:function(){console.log(this.selectedFile),console.log(this.cloneSound);var e=this;e.isLoading=!0,e.$nextTick((function(){e.$refs.loadingVideo.playVideo()})),e.$refs.clonePopup.close(),uni.uploadFile({url:"https://live.tellai.tech/api/news_assistant/figure/clone",filePath:e.selectedFile.path,name:"file",timeout:18e5,formData:{user_id:uni.getStorageSync("userId"),cloneSound:!1},success:function(t){var i=JSON.parse(t.data);"success"===i.status?(e.$tip.toast("克隆成功"),e.queryFigures()):e.$tip.toast(i.message),e.isLoading=!1}})},clonePopupClose:function(){this.selectedFile=null,this.cloneSound=!1,this.$refs.clonePopup.close()},back:function(){uni.switchTab({url:"/pages/template/index"})}}};t.default=s},c7d9:function(e,t,i){var n=i("0821");n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);var a=i("967d").default;a("8200160e",n,!0,{sourceMap:!1,shadowMode:!1})},d095:function(e,t,i){"use strict";i.d(t,"b",(function(){return n})),i.d(t,"c",(function(){return a})),i.d(t,"a",(function(){}));var n=function(){var e=this.$createElement,t=this._self._c||e;return t("v-uni-view",{staticClass:"loading-container"},[t("v-uni-view",{staticClass:"loading-wrapper"},[t("v-uni-video",{ref:"video",staticClass:"loading-video",attrs:{src:"/static/loading.mp4",playsinline:!0,"webkit-playsinline":!0,loop:!0,muted:!0,"object-fit":"cover",controls:!1,"show-center-play-btn":!1}}),t("v-uni-view",{staticClass:"loading-text"},[this._v(this._s(this.text))])],1)],1)},a=[]},d5c4:function(e,t,i){"use strict";i.r(t);var n=i("6794"),a=i("1173");for(var s in a)["default"].indexOf(s)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(s);i("13af");var o=i("828b"),c=Object(o["a"])(a["default"],n["b"],n["c"],!1,null,"281c9d21",null,!1,n["a"],void 0);t["default"]=c.exports}}]);