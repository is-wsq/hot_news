(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-template-videoList"],{"35c9":function(t,e,i){"use strict";i.d(e,"b",(function(){return n})),i.d(e,"c",(function(){return s})),i.d(e,"a",(function(){return a}));var a={uniIcons:i("00f9").default},n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",{staticClass:"pages video"},[i("v-uni-view",{staticClass:"nav-bar-header"},[i("uni-icons",{staticClass:"nav-bar-back",attrs:{type:"left",size:"21",color:"#ffffff"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.back.apply(void 0,arguments)}}}),i("v-uni-view",{staticClass:"nav-bar-title"},[t._v("我的作品")]),t.videoTasks.length>0?i("v-uni-view",{staticClass:"manageBtn",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.manage.apply(void 0,arguments)}}},[t._v("管理")]):t._e()],1),t.videoTasks.length>0||t.showReel.length>0?i("v-uni-view",{staticClass:"video-list"},[t._l(t.videoTasks,(function(e){return i("v-uni-view",{key:e.id,staticClass:"video-item"},[i("v-uni-view",{staticClass:"image-wrapper shining"},[i("v-uni-image",{staticClass:"item-img",attrs:{src:"/static/img/20.png"}}),i("v-uni-view",{staticClass:"shine-layer"}),i("v-uni-view",{staticClass:"loading-title"},[i("v-uni-view",[t._v("视频生成中")]),i("v-uni-view",{staticClass:"dot"},[t._v(t._s(t.dot))])],1)],1),i("v-uni-view",{staticClass:"item-title",staticStyle:{"margin-top":"1px"}},[t._v(t._s(e.name))])],1)})),t._l(t.showReel,(function(e){return i("v-uni-view",{key:e.id,staticClass:"video-item",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.manageVideo(e)}}},[i("v-uni-image",{staticClass:"item-img",class:{"active-item":-1!==t.selectedVideos.findIndex((function(t){return t.id===e.id}))},attrs:{src:e.picture}}),i("v-uni-view",{staticClass:"item-title",style:{color:-1!==t.selectedVideos.findIndex((function(t){return t.id===e.id}))?"#e99d42":"#ffffff"}},[t._v(t._s(e.filename))])],1)}))],2):i("v-uni-view",{staticClass:"empty-list"},[i("uni-icons",{attrs:{fontFamily:"CustomFont",color:"#333333",size:"70"}},[t._v(t._s(""))]),i("v-uni-view",{staticClass:"empty-list-title"},[t._v("暂无作品保存")])],1),i("v-uni-view",{staticClass:"video-footer"},[t.isManage?i("v-uni-button",{staticClass:"delBtn",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.delVideos.apply(void 0,arguments)}}},[t._v("删除")]):i("v-uni-view",[t._v("只保留近三天生成的作品")])],1)],1)},s=[]},"5a3f":function(t,e,i){"use strict";i.r(e);var a=i("689d"),n=i.n(a);for(var s in a)["default"].indexOf(s)<0&&function(t){i.d(e,t,(function(){return a[t]}))}(s);e["default"]=n.a},6521:function(t,e,i){"use strict";var a=i("bbd9"),n=i.n(a);n.a},6757:function(t,e,i){var a=i("c86c");e=a(!1),e.push([t.i,"@font-face{font-family:CustomFont;src:url(/static/iconfont.ttf)}.video[data-v-5fe110a2]{height:100vh}.manageBtn[data-v-5fe110a2]{position:absolute;right:5px;font-size:16px;color:#fff}.video-list[data-v-5fe110a2]{height:calc(100% - 140px);display:grid;grid-template-columns:repeat(auto-fill,minmax(150px,1fr));grid-template-rows:230px;gap:10px;justify-items:center;overflow:auto}.empty-list[data-v-5fe110a2]{height:calc(100% - 140px);display:flex;flex-direction:column;align-items:center;justify-content:center}.empty-list-title[data-v-5fe110a2]{font-size:16px;margin-top:10px;color:#333}.item-img[data-v-5fe110a2]{width:150px;height:200px;border-radius:10px}.item-img.blurred[data-v-5fe110a2]{-webkit-filter:blur(15px);filter:blur(15px);opacity:.8}.loading-title[data-v-5fe110a2]{position:absolute;color:#fff;font-size:14px;width:100%;text-align:center;top:50%;-webkit-transform:translateY(-50%);transform:translateY(-50%);display:flex;align-items:center;justify-content:center}.dot[data-v-5fe110a2]{width:20px;text-align:left;margin-left:5px;font-size:16px;line-height:40px}.item-title[data-v-5fe110a2]{font-size:14px;color:#fff;width:150px;text-align:center;margin-top:5px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.video-footer[data-v-5fe110a2]{height:35px;margin-top:25px;color:#9a9a9a;font-size:14px;text-align:center;line-height:35px}.delBtn[data-v-5fe110a2]{height:35px;line-height:35px;width:255px;border-radius:10px;color:#101010}.active-item[data-v-5fe110a2]{border:2px solid #e99d42}",""]),t.exports=e},"689d":function(t,e,i){"use strict";i("6a54");var a=i("f5bd").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,i("8f71"),i("bf0f"),i("a578"),i("c223"),i("bd06"),i("dd2b"),i("aa9c"),i("fd3c");var n=a(i("9b1b")),s=i("8f59"),o={name:"videoList",data:function(){return{showReel:[],dotCount:1,dotTimer:null,dot:".",isManage:!1,selectedVideos:[]}},computed:(0,n.default)((0,n.default)({},(0,s.mapGetters)("task",["allTasks"])),{},{videoTasks:function(){return this.allTasks.filter((function(t){return"video"===t.type}))}}),watch:{videoTasks:{handler:function(){this.queryReel()},deep:!0}},mounted:function(){this.queryReel(),this.videoTasks.length>0&&this.startDotAnimation()},beforeDestroy:function(){clearInterval(this.dotTimer)},methods:{startDotAnimation:function(){var t=this;this.dotTimer=setInterval((function(){t.dotCount=t.dotCount%3+1,t.dot=".".repeat(t.dotCount)}),1e3)},manage:function(){this.isManage=!this.isManage,this.selectedVideos=[]},manageVideo:function(t){if(this.isManage){var e=this.selectedVideos.findIndex((function(e){return e.id===t.id}));-1!==e?this.selectedVideos.splice(e,1):this.selectedVideos.push(t)}else{var i="/pages/download?filepath=".concat(t.video_path,"&filename=").concat(t.filename);uni.redirectTo({url:i})}},queryReel:function(){var t=this,e={user_id:uni.getStorageSync("userId")};this.$http.get("/video_record/query",e).then((function(e){console.log("111",e),"success"===e.status&&(t.showReel=e.data)}))},delVideos:function(){var t=this,e=this.selectedVideos.map((function(t){return t.id}));0!==e.length?uni.showModal({title:"提示",content:"确定要删除选中的视频吗？",showCancel:!0,success:function(i){i.confirm?t.$http.del("/video_record/batch_delete",{ids:e}).then((function(e){"success"===e.status?(t.selectedVideos=[],t.$tip.toast("删除成功",1e3),t.queryReel()):t.$tip.confirm(e.message,!1)})):i.cancel&&(t.selectedVideos=[],t.$tip.toast("已取消删除",1e3))}}):this.$tip.confirm("请先选择要删除的视频",!1)},back:function(){uni.switchTab({url:"/pages/template/index"})}}};e.default=o},"7d86":function(t,e,i){"use strict";i.r(e);var a=i("35c9"),n=i("5a3f");for(var s in n)["default"].indexOf(s)<0&&function(t){i.d(e,t,(function(){return n[t]}))}(s);i("6521");var o=i("828b"),r=Object(o["a"])(n["default"],a["b"],a["c"],!1,null,"5fe110a2",null,!1,a["a"],void 0);e["default"]=r.exports},a578:function(t,e,i){"use strict";var a=i("8bdb"),n=i("f298");a({target:"String",proto:!0},{repeat:n})},bbd9:function(t,e,i){var a=i("6757");a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var n=i("967d").default;n("739b85e1",a,!0,{sourceMap:!1,shadowMode:!1})},f298:function(t,e,i){"use strict";var a=i("497b"),n=i("9e70"),s=i("862c"),o=RangeError;t.exports=function(t){var e=n(s(this)),i="",r=a(t);if(r<0||r===1/0)throw new o("Wrong number of repetitions");for(;r>0;(r>>>=1)&&(e+=e))1&r&&(i+=e);return i}}}]);