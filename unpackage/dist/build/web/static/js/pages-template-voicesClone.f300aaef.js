(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-template-voicesClone"],{"20f3":function(t,i,e){"use strict";var a=e("8bdb"),n=e("5145");a({target:"Array",proto:!0,forced:n!==[].lastIndexOf},{lastIndexOf:n})},"3fe0":function(t,i,e){"use strict";e.d(i,"b",(function(){return n})),e.d(i,"c",(function(){return o})),e.d(i,"a",(function(){return a}));var a={uniIcons:e("00f9").default},n=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("v-uni-view",{staticClass:"pages voicesClone"},[e("v-uni-view",{staticClass:"nav-bar-header"},[e("uni-icons",{staticClass:"nav-bar-back",attrs:{type:"left",size:"21",color:"#ffffff"},on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.back.apply(void 0,arguments)}}}),e("v-uni-view",{staticClass:"nav-bar-title"},[t._v("音色克隆")]),e("v-uni-view",{staticClass:"voices-list",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.gotoVoices.apply(void 0,arguments)}}},[t._v("音色列表")])],1),e("v-uni-view",{staticClass:"voice-content"},[e("v-uni-view",{staticStyle:{"margin-bottom":"15px"}},[t._v("正确示例")]),e("v-uni-view",{staticStyle:{display:"flex"}},[e("v-uni-view",{staticClass:"template-img"}),e("v-uni-view",{staticClass:"template-requires"},t._l(t.requires,(function(i,a){return e("v-uni-view",{key:a,staticStyle:{height:"40px",display:"flex","align-items":"center"}},[e("uni-icons",{staticStyle:{margin:"0 5px"},attrs:{type:"checkbox-filled",size:"22",color:"#77C285"}}),e("v-uni-view",{staticStyle:{"font-size":"14px"}},[t._v(t._s(i))])],1)})),1)],1),e("v-uni-view",{staticStyle:{margin:"15px 0"}},[t._v("克隆案例")]),e("v-uni-view",{staticStyle:{display:"flex",gap:"30px"}},[e("v-uni-view",{staticClass:"clone-case"},[e("v-uni-view",{staticClass:"clone-case-title"},[t._v("原声")]),e("v-uni-view",{staticClass:"clone-case-btn"},[0!==t.playIndex?e("uni-icons",{staticClass:"off-on",attrs:{fontFamily:"CustomFont",size:"18",color:"#ffffff"},on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.playAudio(0)}}},[t._v(t._s(""))]):e("uni-icons",{staticClass:"off-on",attrs:{fontFamily:"CustomFont",size:"18",color:"#ffffff"},on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.stopAudio()}}},[t._v(t._s(""))])],1)],1),e("v-uni-view",{staticClass:"clone-case"},[e("v-uni-view",{staticClass:"clone-case-title"},[t._v("克隆")]),e("v-uni-view",{staticClass:"clone-case-btn"},[1!==t.playIndex?e("uni-icons",{staticClass:"off-on",attrs:{fontFamily:"CustomFont",size:"18",color:"#ffffff"},on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.playAudio(1)}}},[t._v(t._s(""))]):e("uni-icons",{staticClass:"off-on",attrs:{fontFamily:"CustomFont",size:"18",color:"#ffffff"},on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.stopAudio()}}},[t._v(t._s(""))])],1)],1)],1),e("v-uni-view",{staticStyle:{margin:"15px 0"}},[t._v("音频教程")]),e("v-uni-view",{staticClass:"voice-tutorial"},[e("v-uni-view",{staticClass:"voice-tutorial-btn"},[2!==t.playIndex?e("uni-icons",{staticClass:"off-on",attrs:{fontFamily:"CustomFont",size:"22",color:"#ffffff"},on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.playAudio(2)}}},[t._v(t._s(""))]):e("uni-icons",{staticClass:"off-on",attrs:{fontFamily:"CustomFont",size:"22",color:"#ffffff"},on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.stopAudio()}}},[t._v(t._s(""))])],1)],1)],1),e("v-uni-view",{staticStyle:{height:"90px",display:"flex","align-items":"center",gap:"30px"}},[e("v-uni-button",{staticClass:"transcribe"},[t._v("在线录制")]),e("v-uni-button",{staticClass:"upload",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.uploadFile.apply(void 0,arguments)}}},[t._v("上传文件")])],1)],1)},o=[]},6768:function(t,i,e){var a=e("c86c");i=a(!1),i.push([t.i,"@font-face{font-family:CustomFont;src:url(/static/iconfont.ttf)}.voicesClone[data-v-12b95766]{height:100vh;color:#fff}.voices-list[data-v-12b95766]{position:absolute;right:5px;color:#fff}.voice-content[data-v-12b95766]{height:calc(100% - 150px);overflow-y:auto}.template-img[data-v-12b95766]{background-image:url(/static/img/microphone.png);border-radius:10px;width:180px;height:240px;margin-right:5px;background-size:cover;background-repeat:no-repeat;background-position:50%}.clone-case[data-v-12b95766]{flex:1;border-radius:10px;height:82px;background-image:url(/static/img/case.png);background-size:cover;background-repeat:no-repeat;position:relative}.clone-case-title[data-v-12b95766]{position:absolute;bottom:5px;left:5px;color:#fff;font-size:14px}.clone-case-btn[data-v-12b95766]{position:absolute;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);width:45px;height:45px;border-radius:50%;background-color:rgba(16,16,16,.15);display:flex;justify-content:center;align-items:center}.voice-tutorial[data-v-12b95766]{height:150px;border-radius:10px;background-image:url(/static/img/microphone_copy.png);background-size:cover;background-repeat:no-repeat;position:relative}.voice-tutorial-btn[data-v-12b95766]{position:absolute;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);width:60px;height:60px;border-radius:50%;background-color:rgba(16,16,16,.15);display:flex;justify-content:center;align-items:center}.transcribe[data-v-12b95766]{flex:1;height:55px;line-height:55px;border-radius:10px}.upload[data-v-12b95766]{flex:1;height:55px;line-height:55px;background-color:#e99d42;color:#fff;border-radius:10px}",""]),t.exports=i},"6cdf":function(t,i,e){"use strict";var a=e("f1fa"),n=e.n(a);n.a},9327:function(t,i,e){"use strict";var a=e("8bdb"),n=e("9f69"),o=e("1ded").f,s=e("c435"),c=e("9e70"),r=e("b6a1"),l=e("862c"),u=e("0931"),f=e("a734"),d=n("".slice),p=Math.min,v=u("endsWith"),h=!f&&!v&&!!function(){var t=o(String.prototype,"endsWith");return t&&!t.writable}();a({target:"String",proto:!0,forced:!h&&!v},{endsWith:function(t){var i=c(l(this));r(t);var e=arguments.length>1?arguments[1]:void 0,a=i.length,n=void 0===e?a:p(s(e),a),o=c(t);return d(i,n-o.length,n)===o}})},b93e:function(t,i,e){"use strict";e.r(i);var a=e("3fe0"),n=e("dcec");for(var o in n)["default"].indexOf(o)<0&&function(t){e.d(i,t,(function(){return n[t]}))}(o);e("6cdf");var s=e("828b"),c=Object(s["a"])(n["default"],a["b"],a["c"],!1,null,"12b95766",null,!1,a["a"],void 0);i["default"]=c.exports},dcec:function(t,i,e){"use strict";e.r(i);var a=e("fca3"),n=e.n(a);for(var o in a)["default"].indexOf(o)<0&&function(t){e.d(i,t,(function(){return a[t]}))}(o);i["default"]=n.a},f1fa:function(t,i,e){var a=e("6768");a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var n=e("967d").default;n("18d7c8ce",a,!0,{sourceMap:!1,shadowMode:!1})},fca3:function(t,i,e){"use strict";e("6a54"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0,e("bf0f"),e("9327"),e("5ef2"),e("c223"),e("20f3"),e("c9b5"),e("ab80");var a="Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJodHRwczovL2xpdmUudGVsbGFpLnRlY2giLCJzdWIiOiI3ODNjNGI1NC1hMWQwLTVmY2ItOTExZC1kNWM1YjNjODY2MTAiLCJpYXQiOjE3NDIyMTA0NDQsImV4cCI6MTc1OTc5NTIwMCwibmFtZSI6InRlc3QifQ.OGrW6VfdM7zLVcGjGz9UHblQQlQoHWSriFB90kJOq98",n={data:function(){return{requires:["30秒左右的视频、音频","录制环境安静无杂音","确保录制全程环境一致","保持正常语速、音调","保留自然停顿"],playIndex:null,audioCtx:null,audios:["https://live.tellai.tech/api/news_assistant/static/generated_sample_audio/272f4122-ab74-4bc1-9cd6-c29a41fb508f/20250327145319386.wav","https://live.tellai.tech/api/news_assistant/static/generated_sample_audio/272f4122-ab74-4bc1-9cd6-c29a41fb508f/20250326155734776.wav","https://live.tellai.tech/api/news_assistant/static/generated_sample_audio/272f4122-ab74-4bc1-9cd6-c29a41fb508f/20250326154431855.wav"]}},methods:{uploadFile:function(){var t=this;uni.chooseFile({count:1,success:function(i){var e=i.tempFiles[0].name.toLowerCase(),a=[".mp3",".wav",".m4a",".mp4",".mov"].some((function(t){return e.toLowerCase().endsWith(t)}));if(a){var n=-1!==i.tempFiles[0].type.indexOf("audio")?"audio":"video";t.getFileId(n,i.tempFiles[0])}else t.$tip.confirm("请选择有效的音频文件",!1)}})},getFileId:function(t,i){var e=this,n=this;uni.request({url:"https://live.tellai.tech/api/media/files/upload_request?type=".concat(t),header:{Authorization:a},success:function(o){var s=o.data.base_resp,c=o.data.data;if(200===s.status_code){var r={name:i.name,type:"voice",id:n.generateUniqueId()};n.$store.dispatch("task/addTask",r),n.$tip.confirm("已创建音色克隆任务\n《".concat(i.name,"》"),!1).then((function(t){uni.redirectTo({url:"/pages/template/voice"})})),uni.uploadFile({url:c.upload_url,filePath:i.path,name:"file",header:{Authorization:a},timeout:18e5,formData:{file_id:c.file_id,type:t},success:function(t){var i=JSON.parse(t.data).base_resp,e=JSON.parse(t.data).data;200===i.status_code?n.clone(e.file_id,r):(n.$store.dispatch("task/removeTask",r.id),n.$tip.confirm("".concat(r.name,"音色克隆任务失败,").concat(i.status_msg),!1))}})}else e.$tip.confirm(s.status_msg,!1)}})},clone:function(t,i){var e=this,a={file_id:t,user_id:uni.getStorageSync("userId"),audio_name:i.name.substring(0,i.name.lastIndexOf("."))};this.$http.post("/timbres/clone/file_id",a).then((function(t){e.$store.dispatch("task/removeTask",i.id),"success"===t.status?e.$tip.confirm("".concat(i.name,"音色克隆任务成功"),!1):e.$tip.confirm("".concat(i.name,"音色克隆任务失败,").concat(t.message),!1)}))},playAudio:function(t){var i=this;this.audioCtx&&this.stopAudio(),this.audioCtx=uni.createInnerAudioContext(),this.audioCtx.src=this.audios[t],this.audioCtx.autoplay=!0,this.audioCtx.play(),this.audioCtx.onPlay((function(){i.playIndex=t})),this.audioCtx.onEnded((function(){i.stopAudio()}))},stopAudio:function(){this.audioCtx&&(this.audioCtx.pause(),this.audioCtx.destroy(),this.audioCtx=null,this.playIndex=null)},generateUniqueId:function(){return Date.now()+Math.random().toString(36).substr(2,16)},back:function(){uni.switchTab({url:"/pages/template/index"})},gotoVoices:function(){uni.redirectTo({url:"/pages/template/voice"})}},beforeDestroy:function(){this.stopAudio()}};i.default=n}}]);